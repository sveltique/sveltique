<script module>
export const metadata = {
	description:
		"Provides a consistent structure for form controls, by including a label and an error message when provided."
};
</script>

<script lang="ts">
import { Field, Link, NumberInput, Select, TextInput } from "@sveltique/components";
import Playground from "$components/Playground.svelte";
import { toTitleCase } from "$utils/string.js";

type Input = "text" | "number" | "select";

let type = $state<Input>("text");
let age = $state(16);
let ageError = $derived.by(() => {
	if (age < 18) {
		return "You must be at least 18 years old to participate.";
	}
});

const ageCode = {
	short: `<Field label="Age" error={ageError} class="w-[240px]">
    {#snippet input(props)}
        <NumberInput
            bind:value={age}
            min={0}
            max={99}
            {...props}
        />
    {/snippet}
</Field>`,
	expanded: `&lt;script&gt;
    import { Field, NumberInput } from '@sveltique/components';

    let age = $state(18);
    let ageError = $derived.by(() => {
        if (age < 16 || age > 25) {
            return 'You must be between 16 and 25 years old to participate.';
        }
    });
&lt;/script&gt;

<Field label="Age" error={ageError} class="w-[240px]">
    {#snippet input(props)}
        <NumberInput
            bind:value={age}
            min={0}
            max={99}
            {...props}
        />
    {/snippet}
</Field>`
};
</script>

<h1 id="field">Field</h1>
<p>Provides a consistent structure for form controls, by including a label and an error message when provided.</p>

<h2 id="basic-usage">Basic Usage</h2>
<p>
	The <code>{'<Field />'}</code> accepts any input element, or custom ones such as <Link href="/docs/components/browse/text-input">
        {'<TextInput />'}
    </Link>, <Link href="/docs/components/browse/number-input">{'<NumberInput />'}</Link> or <Link href="/docs/components/browse/select">
        {'<Select />'}
    </Link>.
</p>
<Playground>
	{#if type === 'text'}
		{@render textInput()}
	{:else if type === 'number'}
		{@render numberInput()}
	{:else if type === 'select'}
		{@render selectInput()}
	{/if}

	{#snippet controls()}
		<Field label="Input type">
			{#snippet input(props)}
				<Select.Root bind:value={type} containerClass="w-[200px]" {...props}>
					{#each ['text', 'number', 'select'] as t (t)}
						<Select.Option value={t}>{toTitleCase(t)}</Select.Option>
					{/each}
				</Select.Root>
			{/snippet}
		</Field>
	{/snippet}
</Playground>

<h2 id="error">Error</h2>
<p>You can show an error message under the field by setting the error property.</p>
<p class="text-sm italic text-zinc-500 dark:text-blue-600">
	Tip : Try setting the age above 18 to make the error disappear.
</p>
<Playground code={ageCode}>
	<Field label="Age" error={ageError} class="w-[240px]">
		{#snippet input(props)}
			<NumberInput bind:value={age} min={0} max={99} {...props} />
		{/snippet}
	</Field>
</Playground>

{#snippet textInput()}
	<Field label="Full Name" class="w-[200px]">
		{#snippet input(props)}
			<TextInput {...props} />
		{/snippet}
	</Field>
{/snippet}

{#snippet numberInput()}
	<Field label="Age" class="w-[160px]">
		{#snippet input(props)}
			<NumberInput value={18} min={0} max={99} {...props} />
		{/snippet}
	</Field>
{/snippet}

{#snippet selectInput()}
	<Field label="Fruit">
		{#snippet input(props)}
			<Select.Root placeholder="Choose a fruit" {...props}>
				{#each ['apple', 'banana', 'kiwi', 'mango'] as fruit}
					<Select.Option value={fruit}>{toTitleCase(fruit)}</Select.Option>
				{/each}
			</Select.Root>
		{/snippet}
	</Field>
{/snippet}
